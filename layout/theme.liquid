<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>
    {%- if page_title -%}
      {{ page_title }}{% unless page_title contains shop.name %} - {{ shop.name }}{% endunless %}
    {%- else -%}
      {{ shop.name }}
    {%- endif -%}
  </title>
  
  {%- if page_description -%}
    <meta name="description" content="{{ page_description | escape }}">
  {%- endif -%}
  
  <link rel="canonical" href="{{ canonical_url }}">
  
  {%- if settings.favicon -%}
    <link rel="shortcut icon" href="{{ settings.favicon | img_url: '32x32' }}" type="image/png">
  {%- endif -%}
  
  <!-- Preconnect to improve performance -->
  <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- Critical CSS - Inlined for Performance -->
  <style>{{ 'critical.css' | asset_url | asset }}</style>
  
  <!-- Non-Critical CSS - Lazy Loaded -->
  <link rel="preload" href="{{ 'theme.scss.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ 'theme.scss.css' | asset_url }}"></noscript>
  
  <!-- Shopify head content -->
  {{ content_for_head }}
{{ content_for_header }}</head>
<body class="template-{{ template.name | handle }}">
  <!-- Skip to content link for accessibility -->
  <a href="#main-content" class="skip-link">Skip to main content</a>
  
  <!-- Cart Drawer -->
  {% render 'cart-drawer' %}
  
  <!-- Header -->
  {% section 'header' %}
  
  <!-- Main content -->
  <main id="main-content" role="main">
    {{ content_for_layout }}
  </main>
  
  <!-- Footer -->
  {% section 'footer' %}
  
  <!-- Core JavaScript Modules - Async Loading for Performance -->
  <script src="{{ 'components-navigation.js' | asset_url }}" defer></script>
  <script src="{{ 'components-cart.js' | asset_url }}" defer></script>
  <script src="{{ 'performance-optimizations.js' | asset_url }}" defer></script>
  <script src="{{ 'theme.js' | asset_url }}" defer></script>
  
  <!-- Shopify scripts -->
  {% comment %}
    Shopify's cart drawer and other JS functionality
  {% endcomment %}
  
  {% if request.design_mode %}
    <script>
      // Theme editor specific JavaScript
      document.addEventListener('shopify:section:load', function(event) {
        console.log('Section loaded:', event.detail.sectionId);
      });
    </script>
  {% endif %}
</body>
</html>